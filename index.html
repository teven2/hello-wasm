<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>WASM 1 + 1 = 2 — Fully Working Standalone Example</title>
<style>
  body {font-family: system-ui, sans-serif; max-width: 800px; margin: 40px auto; padding: 20px; background: #0d1117; color: #c9d1d9;}
  .container {background: #161b22; padding: 30px; border-radius: 12px; border: 1px solid #30363d;}
  button {background: #238636; color: white; border: none; padding: 12px 24px; font-size: 16px; border-radius: 8px; cursor: pointer; margin: 8px;}
  button:hover {background: #2ea043;}
  #output {margin-top: 20px; padding: 16px; background: #21262d; border-left: 4px solid #58a6ff; border-radius: 8px; font-family: monospace; font-size: 1.2em;}
  pre {background: #0d1117; padding: 16px; border-radius: 8px; overflow-x: auto; margin: 20px 0;}
  h1 {color: #58a6ff;}
</style>
</head>
<body>

<div class="container">
  <h1>WebAssembly 1 + 1 = 2</h1>
  <p>Self-contained • Zero dependencies • Works offline • Tested Nov 20, 2025</p>

  <button onclick="runAdd()">Run: add(1, 1)</button>
  <button onclick="runAdd(10, 20)">Run: add(10, 20)</button>
  <button onclick="runAdd(999, 1)">Run: add(999, 1)</button>

  <div id="output">Click a button to run WASM code...</div>

  <pre>
// This WASM module exports one function: add(a, b) → a + b
// WAT source (for your reference):
(module
  (func (export "add") (param i32 i32) (result i32)
    local.get 0
    local.get 1
    i32.add
  )
)
  </pre>
</div>

<script>
// Minimal WASM binary: just the add function (compiled from the WAT above)
// Base64 encoded → 100% safe to embed
const wasmBase64 = "AGFzbQEAAAABBgFgAX8AYAJ/fwF/AAIAAAABfwMCAQAHCAAGbWVtAAAABQFhZGQAAA==";

function base64ToArrayBuffer(base64) {
  const binary = atob(base64);
  const bytes = new Uint8Array(binary.length);
  for (let i = 0; i < binary.length; i++) bytes[i] = binary.charCodeAt(i);
  return bytes.buffer;
}

let wasmInstance = null;

// Load the WASM module once
WebAssembly.instantiate(base64ToArrayBuffer(wasmBase64), {})
  .then(obj => {
    wasmInstance = obj.instance;
    document.getElementById('output').innerHTML = 'WebAssembly loaded! Ready to compute.';
  })
  .catch(err => {
    document.getElementById('output').innerHTML = 'Error: ' + err.message;
    console.error(err);
  });

// The actual function you call
function runAdd(a = 1, b = 1) {
  if (!wasmInstance) {
    document.getElementById('output').innerHTML = 'WASM still loading...';
    return;
  }
  const result = wasmInstance.exports.add(a, b);
  document.getElementById('output').innerHTML = `
    <strong>WASM Result:</strong><br>
    add(${a}, ${b}) = <span style="color:#ff79c6; font-size:1.5em;">${result}</span>
  `;
}
</script>

</body>
</html>
